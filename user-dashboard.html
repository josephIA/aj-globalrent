<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>User Dashboard - AJ GlobalRent</title>
<link rel="icon" href="/static/assets/favicon.png">
<style>
:root{--bg:#fff;--text:#000;--btn-bg:#000;--btn-text:#fff;--muted:#555;}
*{box-sizing:border-box;}
body{margin:0;font-family:Inter,sans-serif;background:var(--bg);color:var(--text);}
header{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #ccc;flex-wrap:wrap;}
.logo{font-weight:800;font-size:24px;cursor:default;}
nav button{padding:8px 16px;border:none;border-radius:6px;background:var(--btn-bg);color:var(--btn-text);cursor:pointer;}
.container{max-width:1400px;margin:0 auto;padding:16px;}
h1,h2{margin-bottom:16px;}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;}
.card{border:1px solid #ccc;border-radius:10px;padding:12px;position:relative;}
.card img{width:100%;border-radius:8px;height:160px;object-fit:cover;}
button.details{margin-top:8px;padding:6px 12px;border:none;border-radius:6px;background:var(--btn-bg);color:var(--btn-text);cursor:pointer;}
@media(max-width:768px){ header{flex-direction:column;align-items:flex-start;gap:8px;} }
.modal{position:fixed;inset:0;background: rgba(0,0,0,0.8);display:none;align-items:center;justify-content:center;z-index:9999;}
.modal-content{background:#fff;color:#000;padding:24px;border-radius:12px;max-width:600px;width:90%;position:relative;}
.close{position:absolute;top:8px;right:12px;font-size:20px;cursor:pointer;}
</style>
</head>
<body>
<header>
  <div class="logo">AJ GlobalRent</div>
  <nav>
    <button id="logoutBtn">Sign Out</button>
  </nav>
</header>

<div class="container">
  <h1>Your Favorites</h1>
  <div id="favoritesGrid" class="grid"></div>
</div>

<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <div id="modal-body"></div>
  </div>
</div>

<script>
let currentUser=JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){ alert("Please sign in first"); window.location.href="index.html"; }
const logoutBtn=document.getElementById("logoutBtn");
logoutBtn.onclick=()=>{
  localStorage.removeItem("currentUser"); window.location.href="index.html";
}
const SAMPLE=JSON.parse(localStorage.getItem("sampleListings"));
const favorites=JSON.parse(localStorage.getItem("favorites")) || {};
const favList=(favorites[currentUser.email]||[]);
const container=document.getElementById("favoritesGrid");

favList.forEach(id=>{
  const item=SAMPLE.find(x=>x.id===id);
  if(!item) return;
  const div=document.createElement("div");
  div.className="card";
  div.innerHTML=`<img src="${item.images[0]}">
    <h3>${item.title}</h3>
    <p>${item.state} · ${item.category.toUpperCase()}</p>
    <p><strong>${item.currency} ${item.price.toLocaleString()}</strong></p>
    <button class="details" onclick="openModal(${item.id})">View Details</button>`;
  container.appendChild(div);
});

// Modal
function openModal(id){
  const item=SAMPLE.find(x=>x.id===id);
  const modal=document.getElementById("modal");
  const body=document.getElementById("modal-body");
  body.innerHTML=`<h2>${item.title}</h2>
    <p>${item.state} · ${item.category.toUpperCase()}</p>
    <p>${item.description}</p>
    <p><strong>${item.currency} ${item.price.toLocaleString()}</strong></p>`;
  modal.style.display="flex";
}
function closeModal(){ document.getElementById("modal").style.display="none"; }
</script>
</body>
</html>
